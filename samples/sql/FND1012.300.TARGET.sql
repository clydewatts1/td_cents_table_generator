-- This query selects all columns from a pre-built, denormalized date dimension staging table.
-- The table contains a wide range of calendar and date-related attributes for the current
-- year (TY), last year (LY), two years prior (LLY), three years prior (LLLY), and next year (NY).
SELECT
    -- Current calendar date and its attributes
    STG.calendar_dt,
    STG.year_start_dt,
    STG.year_end_dt,
    STG.period_start_dt,
    STG.period_end_dt,
    STG.week_start_dt,
    STG.week_end_dt,
    STG.day_of_year_num,
    STG.day_of_period_num,
    STG.day_of_week_num,
    STG.week_of_year_num,
    STG.week_of_period_num,
    STG.period_of_year_num,
    STG.year_week,
    STG.year_period,
    STG.year_num,
    -- Seasonal attributes
    STG.season_code,
    STG.season_name,
    STG.season_description,
    STG.season_map,
    STG.season_wid,
    -- Last Year (LY) attributes
    STG.ly_calendar_dt,
    STG.ly_year_start_dt,
    STG.ly_year_end_dt,
    STG.ly_period_start_dt,
    STG.ly_period_end_dt,
    STG.ly_week_start_dt,
    STG.ly_week_end_dt,
    STG.ly_day_of_year_num,
    STG.ly_day_of_period_num,
    STG.ly_day_of_week_num,
    STG.ly_week_of_year_num,
    STG.ly_week_of_period_num,
    STG.ly_period_of_year_num,
    STG.ly_year_week,
    STG.ly_year_period,
    STG.ly_year_num,
    -- Last Last Year (LLY) attributes
    STG.lly_calendar_dt,
    STG.lly_year_start_dt,
    STG.lly_year_end_dt,
    STG.lly_period_start_dt,
    STG.lly_period_end_dt,
    STG.lly_week_start_dt,
    STG.lly_week_end_dt,
    STG.lly_day_of_year_num,
    STG.lly_day_of_period_num,
    STG.lly_day_of_week_num,
    STG.lly_week_of_year_num,
    STG.lly_week_of_period_num,
    STG.lly_period_of_year_num,
    STG.lly_year_week,
    STG.lly_year_period,
    STG.lly_year_num,
    -- Last Last Last Year (LLLY) attributes
    STG.llly_calendar_dt,
    STG.llly_year_start_dt,
    STG.llly_year_end_dt,
    STG.llly_period_start_dt,
    STG.llly_period_end_dt,
    STG.llly_week_start_dt,
    STG.llly_week_end_dt,
    STG.llly_day_of_year_num,
    STG.llly_day_of_period_num,
    STG.llly_day_of_week_num,
    STG.llly_week_of_year_num,
    STG.llly_week_of_period_num,
    STG.llly_period_of_year_num,
    STG.llly_year_week,
    STG.llly_year_period,
    STG.llly_year_num,
    -- Next Year (NY) attributes
    STG.ny_calendar_dt,
    STG.ny_year_start_dt,
    STG.ny_year_end_dt,
    STG.ny_period_start_dt,
    STG.ny_period_end_dt,
    STG.ny_week_start_dt,
    STG.ny_week_end_dt,
    STG.ny_day_of_year_num,
    STG.ny_day_of_period_num,
    STG.ny_day_of_week_num,
    STG.ny_week_of_year_num,
    STG.ny_week_of_period_num,
    STG.ny_period_of_year_num,
    STG.ny_year_week,
    STG.ny_year_period,
    STG.ny_year_num,
    /* Control Columns */
    date '${EFF_TO_DATE}' AS eff_from_dt,
    date '3500-12-31' AS eff_to_dt,
    0 AS del_ind,
    ${RUNID} AS run_id,
    NULL AS update_run_id,
    '$JOB' AS job_id,
    NULL AS update_job_id
FROM
    -- Source is the temporary/staging date dimension table
    DW${INSTANCE}T_TMP_ACC_FND.FND1010_DW_FND_DATE_DIM AS STG